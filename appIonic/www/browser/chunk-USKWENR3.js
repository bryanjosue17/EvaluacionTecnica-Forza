import{a as ne}from"./chunk-6QGGOMUZ.js";import{a as oe}from"./chunk-76FVMFA2.js";import"./chunk-YBY7T5CB.js";import"./chunk-NUEAGB3S.js";import{b as ie}from"./chunk-VQTON5AL.js";import{Ab as U,Bb as W,C as d,Cb as X,D as u,Db as Y,Eb as Z,Ga as z,Hb as ee,Jb as te,K as a,O as x,Q as m,S as r,T as s,U as c,W as I,X as p,Y as _,da as b,ea as l,fa as P,ga as S,hb as L,ib as B,jb as D,kb as O,lb as A,ma as E,mb as G,na as v,nb as H,oa as y,ob as N,pa as V,pb as $,qa as k,qb as j,rb as q,sb as Q,ta as M,tb as J,ua as R,v as h,w as T,wa as F,zb as K}from"./chunk-V5BBYBEN.js";import"./chunk-QL7EMX3B.js";import"./chunk-KISXJL5B.js";import"./chunk-HJQ5J22D.js";import"./chunk-HC6MZPB3.js";import"./chunk-763F6G4M.js";import"./chunk-TPFYUTHI.js";import"./chunk-WND7HVWL.js";import"./chunk-Z6EYHB5B.js";import"./chunk-ZRULQIYR.js";import"./chunk-D3ZZG42Y.js";import"./chunk-PNSU6RTT.js";import"./chunk-MM5QLNJM.js";import"./chunk-WTBOK45U.js";import"./chunk-DLDB5PET.js";import"./chunk-JXIEZMHN.js";import"./chunk-IDJ2LIQM.js";import"./chunk-MCRJI3T3.js";import"./chunk-QVBGS5B3.js";import"./chunk-GAXET6VH.js";import"./chunk-6A2YPY52.js";import"./chunk-5W6SV7YT.js";import"./chunk-33E37TNX.js";import"./chunk-3R6QK3UX.js";import"./chunk-WYPTRRHD.js";import"./chunk-4WFVMWDK.js";import"./chunk-MDMZPGPE.js";import"./chunk-B43CU5JX.js";import"./chunk-TQEIIVVC.js";import"./chunk-X7ZBJCWB.js";import"./chunk-LF5XB4YN.js";import{g as w}from"./chunk-LDRJ6W7P.js";var re=o=>["/product",o];function se(o,g){if(o&1){let e=I();r(0,"ion-col",10)(1,"ion-card")(2,"ion-card-header")(3,"ion-card-title"),l(4),s(),r(5,"ion-card-subtitle"),l(6),y(7,"currency"),s()(),r(8,"ion-card-content")(9,"p"),l(10),s(),r(11,"ion-button",11),c(12,"ion-icon",12),l(13," Ver Detalles "),s(),r(14,"ion-button",13),p("click",function(){let n=d(e).$implicit,i=_(2);return u(i.addToCart(n))}),c(15,"ion-icon",14),l(16),s()()()()}if(o&2){let e,t,n,i=g.$implicit,f=_(2);a(4),P(i.name),a(2),P(V(7,6,i.price,"GTQ")),a(4),P(i.description),a(),m("routerLink",v(9,re,(e=i.id)!==null&&e!==void 0?e:i.productId)),a(3),m("disabled",f.adding[(t=i.id)!==null&&t!==void 0?t:i.productId]),a(2),S(" ",f.adding[(n=i.id)!==null&&n!==void 0?n:i.productId]?"Agregando...":"Agregar al Carrito"," ")}}function ae(o,g){if(o&1&&(r(0,"ion-grid")(1,"ion-row"),x(2,se,17,11,"ion-col",9),s()()),o&2){let e=_();a(2),m("ngForOf",e.filteredProducts)}}function le(o,g){o&1&&(r(0,"div",15),c(1,"ion-spinner",16),r(2,"p"),l(3,"Cargando productos..."),s()())}function ce(o,g){if(o&1){let e=I();r(0,"ion-infinite-scroll",17),p("ionInfinite",function(n){d(e);let i=_();return u(i.loadMore(n))}),c(1,"ion-infinite-scroll-content"),s()}}var Pe=(()=>{class o{constructor(){this.products=[],this.filteredProducts=[],this.loading=!0,this.hasMore=!1,this.currentPage=1,this.searchTerm="",this.adding={},this.catalog=h(ne),this.orders=h(oe),this.menu=h(ie)}ngOnInit(){this.loadProducts()}openMenu(){return w(this,null,function*(){try{yield customElements.whenDefined("ion-menu"),yield this.menu.enable(!0,"main-menu"),yield this.menu.open("main-menu")}catch(e){console.warn("openMenu() error",e)}})}loadProducts(e=1,t=!1){this.loading=!t,this.catalog.list(e,20).subscribe({next:n=>{t?this.products=[...this.products,...n.items]:this.products=n.items,this.filteredProducts=this.products,this.hasMore=n.items.length===20,this.currentPage=e,this.loading=!1},error:()=>{this.loading=!1}})}doRefresh(e){this.currentPage=1,this.loadProducts(1,!1),e.target.complete()}loadMore(e){this.loadProducts(this.currentPage+1,!0),e.target.complete()}filterProducts(e){this.searchTerm=e.target.value.toLowerCase(),this.filteredProducts=this.products.filter(t=>t.name.toLowerCase().includes(this.searchTerm)||t.description&&t.description.toLowerCase().includes(this.searchTerm))}addToCart(e){let t=e.id??e.productId;this.adding[t]=!0,this.orders.addToCart({productId:t,qty:1,unitPrice:e.price,name:e.name}).subscribe({next:()=>{this.adding[t]=!1},error:()=>{this.adding[t]=!1}})}static{this.\u0275fac=function(t){return new(t||o)}}static{this.\u0275cmp=T({type:o,selectors:[["app-products"]],standalone:!0,features:[E],decls:15,vars:3,consts:[["loadingTemplate",""],["color","light"],["slot","start"],["fill","clear",3,"click"],["name","menu-outline"],["slot","fixed",3,"ionRefresh"],["placeholder","Buscar productos...",3,"ionInput"],[4,"ngIf","ngIfElse"],[3,"ionInfinite",4,"ngIf"],["size","12","size-md","6","size-lg","4",4,"ngFor","ngForOf"],["size","12","size-md","6","size-lg","4"],["fill","outline","expand","block",3,"routerLink"],["name","eye","slot","start"],["color","success","expand","block",3,"click","disabled"],["name","add","slot","start"],[1,"ion-text-center","ion-padding"],["name","crescent"],[3,"ionInfinite"]],template:function(t,n){if(t&1){let i=I();r(0,"ion-header")(1,"ion-toolbar",1)(2,"ion-buttons",2)(3,"ion-button",3),p("click",function(){return d(i),u(n.openMenu())}),c(4,"ion-icon",4),s()(),r(5,"ion-title"),l(6,"Cat\xE1logo"),s()()(),r(7,"ion-content")(8,"ion-refresher",5),p("ionRefresh",function(C){return d(i),u(n.doRefresh(C))}),c(9,"ion-refresher-content"),s(),r(10,"ion-searchbar",6),p("ionInput",function(C){return d(i),u(n.filterProducts(C))}),s(),x(11,ae,3,1,"ion-grid",7)(12,le,4,0,"ng-template",null,0,k)(14,ce,2,0,"ion-infinite-scroll",8),s()}if(t&2){let i=b(13);a(11),m("ngIf",!n.loading)("ngIfElse",i),a(3),m("ngIf",n.hasMore)}},dependencies:[$,q,Y,Z,te,Q,J,K,U,j,W,N,D,O,A,H,G,X,L,ee,B,z,M,R,F],encapsulation:2})}}return o})();export{Pe as ProductsPage};
